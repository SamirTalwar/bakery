working-directory: .

shell:
  - bash
  - -e

tests:
  - name: files/one
    command: ./bake.hs one.file
    files:
      - path: one.file
        contents: |
          one
    revert:
      - .

  - name: files/two
    command: ./bake.hs two.file
    files:
      - path: two.file
        contents: |
          two
    revert:
      - .

  - name: files/both
    command: ./bake.hs one.file two.file
    files:
      - path: one.file
        contents: |
          one
      - path: two.file
        contents: |
          two
    revert:
      - .

  - name: files/cat
    command: ./bake.hs cat.file
    files:
      - path: cat.file
        contents: |
          one
          two
    revert:
      - .

  - name: files/cat-existing
    command: |
      echo 'extra content' > existing.file
      ./bake.hs cat-existing.file
    files:
      - path: cat-existing.file
        contents: |
          extra content
          one
          two
    revert:
      - .

  - name: files/cat-no-existing
    command: ./bake.hs cat-existing.file
    exit-status: 1
    stderr: |
      bake.hs: user error (Expected existing.file to exist.)
    revert:
      - .

  - name: files/copy
    command: |
      echo 'this is very important' > existing.file
      ./bake.hs copy.file
    files:
      - path: copy.file
        contents: |
          this is very important
    revert:
      - .
