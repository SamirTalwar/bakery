shell:
  - bash
  - -e

tests:
  - name: echo
    working-directory: echo
    command: ./bake.hs
    files:
      - path: echo/output.file
        contents: |
          Hello, world!
    revert:
      - echo

  - name: two/two
    working-directory: two
    command: ./bake.hs
    files:
      - path: two/two.file
        contents: |
          two
    revert:
      - two

  - name: two/one
    working-directory: two
    command: ./bake.hs one.file
    files:
      - path: two/one.file
        contents: |
          one
    revert:
      - .

  - name: two/both
    working-directory: two
    command: ./bake.hs one.file two.file
    files:
      - path: two/one.file
        contents: |
          one
      - path: two/two.file
        contents: |
          two
    revert:
      - .

  - name: uppercase/no-input
    working-directory: uppercase
    command: ./bake.hs
    exit-status: 1
    stderr: |
      bake.hs: user error (Expected input.file to exist.)
    revert:
      - .

  - name: uppercase/with-input
    working-directory: uppercase
    command: |
      echo lorem ipsum > input.file
      ./bake.hs
    files:
      - path: uppercase/output.file
        contents: |
          LOREM IPSUM
    revert:
      - .

  - name: exec/count
    working-directory: exec
    command: |
      ./bake.hs
    stdout: |
      1
      2
      3
      4
      5
      6
      7
      8
      9
      10
